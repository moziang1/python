```python
import tkinter as tk
import pymysql
from tkinter import *
import tkinter.messagebox as tkm  #弹窗函数

import threading
'''
    连接数据库
'''

# 初始化环境创建库，创建表
def initmysql():
    # 连接数据库创建zxz库
    db = pymysql.connect(host='192.168.1.1', port=3306,
                         user='root',
                         passwd='123.com',
                         charset='utf8')

    try:
        # 应用数据库连接
        cursor = db.cursor()
        cursor.execute('create database zxz')
        db.commit()

    except:
        print('\n')

    # 创建数据库链接
    db = pymysql.connect(host='192.168.1.1', port=3306,
                         user='root',
                         passwd='123.com',
                         charset='utf8', db='zxz')

    # 应用数据库连接
    cursor = db.cursor()
    # 在zxz库中创建表（存储用户信息） 应该是存在于初始化的时候

    # unique 独一无二的
    sql = 'create table sjbinfo( ID int(4) auto_increment primary key \
                     ,zname varchar(20) not null unique \
                     ,zpwd varchar(20) not null \
                     ,level int(4) \
                     ,jinbi int(4)\
                     ,jingyan int(4) \
                     ,lscs int(4)\
                     ,ycls int(4) \
                     ,jihuicishu int(4));'

    # 尝试执行sql语句
    try:
        cursor.execute(sql)  # 提交到我们的数据
        db.commit()
        print('\n')

    except:
        db.rollback()  # 如果报错的话，则回滚数据库（不修改数据库）

    # 关闭
    db.close()

#用于连接数据库查询用户是否存在(select)
def chaxunmysql(sql='select * from sjbinfo;'):
    #pass 查询数据库
    db = pymysql.connect(host='192.168.1.1', port=3306,
                         user='root',
                         passwd='123.com',
                         charset='utf8', db='zxz')
    cursor = db.cursor()

    # 异常排查尝试
    cursor.execute(sql)  # 执行sql语句
    row = cursor.fetchall()
    db.close()
    return row


#修改数据库中的数据，我们这里是更新或添加到数据库信息
def updatemysql(sql):
    #pass 查询数据库
    db = pymysql.connect(host='192.168.1.1', port=3306,
                         user='root',
                         passwd='123.com',
                         charset='utf8', db='zxz')
    cursor = db.cursor()

    # 异常排查尝试
    cursor.execute(sql)  # 执行sql语句
    db.commit()  # 将操作提交到数据库
    db.close()




'''
    用户注册类
'''

#用户名和密码都合格了，进行初始化后上传到数据库
def zuce3(na,pw):
    # 初始值
    level = '0'
    jinbi = '0'
    jingyan = '0'
    lscs = '0'
    ycls = '0'


    # 创建插入语句 (将用户密码及初始值都写入到对应的字段)(%s,格式化字符串后无法导入到数据库，所以用户名和密码不格式化
    sql = """insert into zxz.sjbinfo(zname,zpwd,level,jinbi,jingyan,lscs,ycls)values('"""+na+"""','"""+pw+"""','%s','%s','%s','%s','%s')""" % (level,jinbi,jingyan,lscs,ycls)


    updatemysql(sql)
    tkm.showinfo('提示', '用户注册成功')

    #清除文本框信息，不然会无限循环
    ext1.delete(0, 'end')
    ext2.delete(0, 'end')
    ext3.delete(0, 'end')


    #关闭注册界面元素
    txt1.place_forget()
    txt2.place_forget()
    txt3.place_forget()
    txt4.place_forget()

    #关闭注册界面交互元素
    ext1.place_forget()
    ext2.place_forget()
    ext3.place_forget()

    #清除注册界面按钮元素
    hi_therex.place_forget()

#将用户输入的信息去数据库中查询对比 然后交给zuce2
def zuce2():
    #将用户输入的信息提取出来
    while True:
        # 检测用户输入是否为空

        var1 = ext1.get()
        var2 = ext2.get()
        var3 = ext3.get()

        if not var1.strip():
            tkm.showinfo('提示', '您的输入为空')
            break

        #去找数据库得到查询数据
        row = chaxunmysql()

        a = 0


        #将输入的用户名去对比
        for i in row:
            if var1 in i:
                a += 1
                tkm.showinfo('提示', '您输入的用户以存在')
                ext1.delete(0, 'end')
                break

        if a == 0:
            if var2 != var3:
                tkm.showinfo('提示', '两次输入的密码不相同')
            else:
                tkm.showinfo('提示', '注册成功，正在上传数据，请关闭窗口进行登陆')
                zuce3(var1,var2)

#注册1  创建注册窗口，调用激活按键
def zuce1():
    #将注册元素进行部署
    txt1.place(x=100, y=50)
    txt2.place(x=40, y=100)
    txt3.place(x=40, y=150)
    txt4.place(x=40, y=180)
    ext1.place(x=120, y=100)
    ext2.place(x=120, y=150)
    ext3.place(x=120, y=180)

    # #注册按钮
    #imagex = tk.PhotoImage(file=r"img\denglu.png")
    hi_therex.place(x=200, y=220)



'''
    用户登陆类
'''






#定义剑客功能按钮
def zjgongji():
    global renwuhp,guaiwu1hp
    #清除已有的文本
    jiankehp.place_forget()


    #显示血量
    guaiwu1hp -= 3      #怪物血量
    renwuhp -= 2      #人物血量



    # 人物第一级元素
    jiankehp3 = tk.Label(win, text=renwuhp, bg='red', width=renwuhp, height=1)
    jiankemp3 = tk.Label(win, text=renwump, bg='blue', width=renwump, height=1)
    jiankehp3.place(x=200, y=252)
    jiankemp3.place(x=200, y=275)


        #做到这里发生了奇怪的bug，只有第一次攻击的时候，元素会出现，减少
        #想到的解决方法很简单，学老朱的方法，点击第一下，就给一下元素
        #举例： 设定一个全局变量，例如a= 0 ，点一下攻击，全局变量+1
        #判断是第几下攻击，麻烦的就是要多写几个用户元素元素，别乱跑，就是这个地方，上面的人物第一级元素这段
        #复制它几次，然后判断是第几次用







#游戏界面部署
def youxi(row):
    # 清除主界面背景图
    zhutibeijing.pack_forget()
    # 启动第二张背景图
    theLabel2.pack()

########################################部署人物信息##################################################

    renwutouxing.place(x=10,y=10)    #部署角色头像图片（按钮）
    #部署人物信息
    level = tk.Label(win, text='等级 ' + str(row[3]) +' 级')
    jinbi = tk.Label(win, text='金币' + str(row[4]))
    jingyan = tk.Label(win, text='EXP ' + str(row[5]))
    menpai = tk.Label(win, text='门派： ' + '大唐官府')

    level.place(x=150,y=20)
    jinbi.place(x=150,y=50)
    jingyan.place(x=150,y=80)
    menpai.place(x=150,y=110)
    # jineng = tk.Label(win, text='技能 ' + '横扫千军')
    # jineng.place(x=150,y=110)


##############################部署人物坐标#############################################################################
    #人物部署坐标
    jiankexinxi.place(x=200,y=300)

    #部署人物hp和mp
    jiankehp.place(x=200, y=252)
    jiankemp.place(x=200, y=275)





#############################怪物部署坐标##################################################################################

    #部署怪物坐标
    guaiwu1.place(x=500,y=300)

    #怪物hp和mp
    temp1hp.place(x=500, y=252)
    temp2mp.place(x=500, y=275)



    #部署按钮 攻击   技能,吃药按钮
    gongjianniu.place(x=100,y=250)
    jinenganniu.place(x=100,y=380)
    chiyaoganniu.place(x=100,y=320)


#定义输入后
def getValues():

    va1 = Ent1.get()  #获取用户输入的用户名信息
    va2 = Ent2.get()  #密码

    #链接数据库拿到数据
    row = chaxunmysql()

    a = 0
    for i in row:
        if va1 in i:
            if va2 == i[2]:
                print('登陆成功')
                a +=1
                lab1.place_forget()
                lab2.place_forget()
                lab3.place_forget()
                Ent1.place_forget()
                Ent2.place_forget()
                hi_there.place_forget()
                zuce.place_forget()


                #在用户登陆时修改全局变量
                #跳转游戏界面
                youxi(i)
    if a == 0:
        tkm.showinfo('消息','您输入的用户或密码不正确')



#定义人物的基本熟悉
class jianke():
    hp = 17
    mp = 17
    def jineng(self):
        pass
jianke=jianke()

class guaiwux1():
    hp = 17
    mp = 17
    exp = 100
    jinbi = 50
    def jineng(self):
        pass
guaiwux1 = guaiwux1()






######################################## 1. 实际执行代码区域###################################################################
#先初始化数据库
initmysql()


#定义全局窗口
win = tk.Tk()
win.title('登陆界面')
win.geometry('850x480')
win.resizable(1, 1)



########################################2 .定义框架区域元素#############################################################

#在底层界面定义框架
frm= tk.Frame(win,width=850,height=480)
frm.pack()  # 部署框架元素




#基于框架添加背景图

#添加第一个场景背景元素
zhutibeijingimg = PhotoImage(file=r"img\zhuti2.png")
zhutibeijing = Label(frm,justify=LEFT,image=zhutibeijingimg,compound=CENTER,fg='white')
zhutibeijing.pack()   #给部署框架元素图片


#部署第二个场景的背景图

photo2 = PhotoImage(file=r"img\zhuti3.png")
theLabel2 = Label(frm,justify=LEFT,image=photo2,compound=CENTER,fg='white')




############################################# 3  定义主界面信息####################################################



#用户登陆元素
lab2 = tk.Label(win, text='用户名', bg='black', fg='gold',font=20)
lab3 = tk.Label(win, text='密码', bg='black', fg='gold',font=20)

#部署用户登陆交互元素
Ent1 = tk.Entry(win)
Ent2 = tk.Entry(win,show='*')

#部署用户登陆元素
lab2.place(x=400, y=200)
lab3.place(x=400, y=250)

#部署用户登陆交互
Ent1.place(x=500, y=200)
Ent2.place(x=500, y=250)





#定义主界面登陆按钮
imagex = tk.PhotoImage(file=r"img\denglu.png")
hi_there = tk.Button(win, image=imagex, command=getValues)
hi_there.place(x=400, y=400)   #登陆用户的按钮


#定义主界面用户注册按钮
zuce = tk.Button(win, text='注册', bg='SkyBlue', fg='LimeGreen', command=zuce1)
zuce.place(x=650, y=200)  #定义主界面用户注册的按钮


#定义主界面 logs元素
image = tk.PhotoImage(file=r"img\logs.png")
lab1 = tk.Label(win, image=image)
lab1.place(x=450, y=50)  #部署用户登陆界面logs元素



############################################4  用户注册#####################################################
#定义注册页面的元素
# 注册 窗口元素
txt1 = tk.Label(win, text='注册用户', bg='black', fg='gold', font=20)
txt2 = tk.Label(win, text='用户名', bg='black', fg='gold', font=20)
txt3 = tk.Label(win, text='密码1', bg='black', fg='gold', font=20)
txt4 = tk.Label(win, text='密码2', bg='black', fg='gold', font=20)


# 定义注册交互框
ext1 = tk.Entry(win)
ext2 = tk.Entry(win)
ext3 = tk.Entry(win)

#定义注册页面  用户注册的按钮
hi_therex = tk.Button(win, text='点击注册', bg='black', fg='white', command=zuce2)


#######################################################################################################################
                                        #第一部分，构建用户注册，用户登陆元素，元素部署
#######################################################################################################################
                                        #第二部分  构建人物信息框架以及对局
#######################################################################################################################


#人物头像按钮
imagejianke = tk.PhotoImage(file=r"img\jianke.png")
renwutouxing = tk.Button(win, image=imagejianke)#command=jiankexinxi)


#人物图形(jianke）
photo3 = tk.PhotoImage(file=r"img\jianke.png")
jiankexinxi = tk.Label(win, image=photo3)



#获取人物hp和mp作为全局
renwuhp = jianke.hp  # 定义人物的hp和法力值的图形
renwump = jianke.mp


#攻击按钮
gongjianniu = tk.Button(win, text='攻击', bg='black', fg='white',command=zjgongji)#,command=pass

#技能按钮
jinenganniu = tk.Button(win, text='技能', bg='black', fg='white') #,command=pass

#吃药按钮
chiyaoganniu = tk.Button(win, text='吃药', bg='black', fg='white')

#角色萧条颜色
jiankehp = tk.Label(win, text=renwuhp, bg='red', width=renwuhp, height=1)
jiankemp = tk.Label(win, text=renwump, bg='blue', width=renwump, height=1)




################################定义怪物1#################################################



#我是怪物1
guaiwux = tk.PhotoImage(file=r"img\jianke.png")
guaiwu1 = tk.Label(win, image=guaiwux)

#获取怪物hpmp作为全局
guaiwu1hp = guaiwux1.hp
guaiwu1mp = guaiwux1.mp



#怪物第二背景hp显示
temp1hp = tk.Label(win, text=guaiwu1hp, bg='red', width=guaiwu1hp, height=1)
temp2mp = tk.Label(win, text=guaiwu1mp, bg='blue', width=guaiwu1mp, height=1)




#消息循环
win.mainloop()

```







动态图加载

```python
#首先引入pyglet包
import pyglet

#主方法源码：
# 在工作目录中选择一个gif动画文件
ag_file = "11.gif"

#绑定图片资源
animation = pyglet.resource.animation(ag_file)
sprite = pyglet.sprite.Sprite(animation)


# 创建一个窗口并将其设置为图像大小
win = pyglet.window.Window(width=sprite.width, height=sprite.height)



# 设置窗口背景颜色 = r, g, b, alpha

green = 0, 1, 0, 1    ## 每个值从 0.0 到 1.0

pyglet.gl.glClearColor(*green)  #设置颜色缓存的清除值


@win.event   #运行动态图有关

def on_draw():

    win.clear()   #停止当前的帧
    sprite.draw()  #运行下一帧

#启动图片
pyglet.app.run()
```

